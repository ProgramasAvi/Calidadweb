function calcular() {
  con = 0;
  try {
    var a0 = parseFloat(document.getElementById("controlCa").value) || 0,
      a1 = parseFloat(document.getElementById("controlCz").value) || 0,
      a2 = parseFloat(document.getElementById("controlCc").value) || 0,
      a3 = parseFloat(document.getElementById("controlCd").value) || 0,
      a4 = parseFloat(document.getElementById("controlCe").value) || 0,
      a5 = parseFloat(document.getElementById("controlCf").value) || 0,
      a6 = parseFloat(document.getElementById("controlCg").value) || 0,
      a7 = parseFloat(document.getElementById("controlCh").value) || 0,
      a8 = parseFloat(document.getElementById("controlCi").value) || 0,
      a9 = parseFloat(document.getElementById("controlCj").value) || 0,
      a10 = parseFloat(document.getElementById("controlCk").value) || 0,
      a11 = parseFloat(document.getElementById("controlCl").value) || 0,
      a12 = parseFloat(document.getElementById("controlCm").value) || 0,
      a13 = parseFloat(document.getElementById("controlCn").value) || 0,
      a14 = parseFloat(document.getElementById("controlCñ").value) || 0;

    document.getElementById("tempPromedio").value =
      (a0 +
        a1 +
        a2 +
        a3 +
        a4 +
        a5 +
        a6 +
        a7 +
        a8 +
        a9 +
        a10 +
        a11 +
        a12 +
        a13 +
        a14) /
      15;

    if (a0 <= 4) {
      con++;
    }

    if (a1 <= 4) {
      con++;
    }

    if (a2 <= 4) {
      con++;
    }
    if (a3 <= 4) {
      con++;
    }
    if (a4 <= 4) {
      con++;
    }
    if (a5 <= 4) {
      con++;
    }
    if (a6 <= 4) {
      con++;
    }
    if (a7 <= 4) {
      con++;
    }
    if (a8 <= 4) {
      con++;
    }
    if (a9 <= 4) {
      con++;
    }
    if (a10 <= 4) {
      con++;
    }
    if (a11 <= 4) {
      con++;
    }
    if (a12 <= 4) {
      con++;
    }
    if (a13 <= 4) {
      con++;
    }
    if (a14 <= 4) {
      con++;
    }

    document.getElementById("porcenCumplimiento").value = parseInt(
      (con * 100) / 15
    );
    var e1 = document.getElementById("porcenCumplimiento").value;
    if (e1 < 100) {
      document.getElementById("porcenCumplimiento").style.backgroundColor =
        "red";
      document.getElementById("porcenCumplimiento").style.fontWeight = "800";
    } else {
      document.getElementById("porcenCumplimiento").style.fontWeight = "400";
      document.getElementById("porcenCumplimiento").style.backgroundColor =
        "#e8ecef";
    }
  } catch (error) {
    console.log(error);
  }
}

const porcentEscaldado = () => {
  var count = $("#selectEsc :selected").length;
  var ttl = 43;

  $("#pcEscaldado").val(parseFloat(((ttl - count) * 100) / ttl).toFixed(2));
};
const porcentEviscera = () => {
  var count = $("#selectEvisc :selected").length;
  var ttl = 48;

  $("#pcEviscera").val(parseFloat(((ttl - count) * 100) / ttl).toFixed(2));
};
const porcentVisceras = () => {
  var count = $("#selectViscera :selected").length;
  var ttl = 36;

  $("#pcVisceras").val(parseFloat(((ttl - count) * 100) / ttl).toFixed(2));
};
const porcentEnfriamiento = () => {
  var count = $("#selectEnfri :selected").length;
  var ttl = 48;

  $("#pcEnfriamiento").val(parseFloat(((ttl - count) * 100) / ttl).toFixed(2));
};
const porcentDesprese = () => {
  var count = $("#selectDespre :selected").length;
  var ttl = 42;

  $("#pcDesprese").val(parseFloat(((ttl - count) * 100) / ttl).toFixed(2));
};
const porcentDeshuese = () => {
  var count = $("#selectDeshuese :selected").length;
  var ttl = 23;

  $("#pcDeshuese").val(parseFloat(((ttl - count) * 100) / ttl).toFixed(2));
};
const porcentFileteo = () => {
  var count = $("#selectFileteo :selected").length;
  var ttl = 36;

  $("#pcFileteo").val(parseFloat(((ttl - count) * 100) / ttl).toFixed(2));
};
const porcentProceso = () => {
  var count = $("#selectPosProc :selected").length;
  var ttl = 34;

  $("#pcProceso").val(parseFloat(((ttl - count) * 100) / ttl).toFixed(2));
};
const porcentHielo = () => {
  var count = $("#selectHielo :selected").length;
  var ttl = 8;

  $("#pcHielo").val(parseFloat(((ttl - count) * 100) / ttl).toFixed(2));
};
const porcentSalmuera = () => {
  var count = $("#selectSalmu :selected").length;
  var ttl = 8;

  $("#pcSalmuera").val(parseFloat(((ttl - count) * 100) / ttl).toFixed(2));
};
const porcentAlimentacion = () => {
  var count = $("#selectAlimen :selected").length;
  var ttl = 8;

  $("#pcAlimenta").val(parseFloat(((ttl - count) * 100) / ttl).toFixed(2));
};
const porcentCanastilla = () => {
  var count = $("#selectCanast :selected").length;
  var ttl = 9;

  $("#pcCanastilla").val(parseFloat(((ttl - count) * 100) / ttl).toFixed(2));
};
const porcentLavanderia = () => {
  var count = $("#selectLavan :selected").length;
  var ttl = 8;

  $("#pcLavanderia").val(parseFloat(((ttl - count) * 100) / ttl).toFixed(2));
};
const pCumpliPreOpe = () => {
  pcEscaldado = parseInt($("#pcEscaldado").val());
  pcEviscera = parseInt($("#pcEviscera").val());
  pcVisceras = parseInt($("#pcVisceras").val());
  pcEnfriamiento = parseInt($("#pcEnfriamiento").val());
  pcDesprese = parseInt($("#pcDesprese").val());
  pcDeshuese = parseInt($("#pcDeshuese").val());
  pcFileteo = parseInt($("#pcFileteo").val());
  pcProceso = parseInt($("#pcProceso").val());
  pcHielo = parseInt($("#pcHielo").val());
  pcSalmuera = parseInt($("#pcSalmuera").val());
  pcAlimenta = parseInt($("#pcAlimenta").val());
  pcCanastilla = parseInt($("#pcCanastilla").val());
  pcLavanderia = parseInt($("#pcLavanderia").val());
  $("#pCumplimientoPreOpe").val(
    (
      (pcEscaldado +
        pcEviscera +
        pcVisceras +
        pcEnfriamiento +
        pcDesprese +
        pcDeshuese +
        pcFileteo +
        pcProceso +
        pcHielo +
        pcSalmuera +
        pcAlimenta +
        pcCanastilla +
        pcLavanderia) /
      13
    ).toFixed(3)
  );
};
function porcentajeEvisc() {
  evi = 0;
  try {
    var m0 = parseFloat(document.getElementById("HM01").value) || 0,
      m1 = parseFloat(document.getElementById("HM02").value) || 0,
      m2 = parseFloat(document.getElementById("HM03").value) || 0,
      m3 = parseFloat(document.getElementById("HM04").value) || 0,
      m4 = parseFloat(document.getElementById("HM05").value) || 0,
      m5 = parseFloat(document.getElementById("MM01").value) || 0,
      m6 = parseFloat(document.getElementById("MM02").value) || 0,
      m7 = parseFloat(document.getElementById("MM03").value) || 0,
      m8 = parseFloat(document.getElementById("MM04").value) || 0,
      m9 = parseFloat(document.getElementById("MM05").value) || 0,
      m10 = parseFloat(document.getElementById("PM01").value) || 0,
      m11 = parseFloat(document.getElementById("PM02").value) || 0,
      m12 = parseFloat(document.getElementById("PM03").value) || 0,
      m13 = parseFloat(document.getElementById("PM04").value) || 0,
      m14 = parseFloat(document.getElementById("PM05").value) || 0,
      m15 = parseFloat(document.getElementById("CM01").value) || 0,
      m16 = parseFloat(document.getElementById("CM02").value) || 0,
      m17 = parseFloat(document.getElementById("CM03").value) || 0,
      m18 = parseFloat(document.getElementById("CM04").value) || 0,
      m19 = parseFloat(document.getElementById("CM05").value) || 0;

    if (m0 <= 4) {
      evi++;
    }

    if (m1 <= 4) {
      evi++;
    }

    if (m2 <= 4) {
      evi++;
    }
    if (m3 <= 4) {
      evi++;
    }
    if (m4 <= 4) {
      evi++;
    }
    if (m5 <= 4) {
      evi++;
    }
    if (m6 <= 4) {
      evi++;
    }
    if (m7 <= 4) {
      evi++;
    }
    if (m8 <= 4) {
      evi++;
    }
    if (m9 <= 4) {
      evi++;
    }
    if (m10 <= 4) {
      evi++;
    }
    if (m11 <= 4) {
      evi++;
    }
    if (m12 <= 4) {
      evi++;
    }
    if (m13 <= 4) {
      evi++;
    }
    if (m14 <= 4) {
      evi++;
    }
    if (m15 <= 4) {
      evi++;
    }
    if (m16 <= 4) {
      evi++;
    }
    if (m17 <= 4) {
      evi++;
    }
    if (m18 <= 4) {
      evi++;
    }
    if (m19 <= 4) {
      evi++;
    }

    document.getElementById("cumplimientoEvisce").value = parseInt(
      (evi * 100) / 20
    );
    var e1 = document.getElementById("cumplimientoEvisce").value;
    if (e1 < 100) {
      document.getElementById("cumplimientoEvisce").style.backgroundColor =
        "red";
      document.getElementById("cumplimientoEvisce").style.fontWeight = "800";
    } else {
      document.getElementById("cumplimientoEvisce").style.fontWeight = "400";
      document.getElementById("cumplimientoEvisce").style.backgroundColor =
        "#e8ecef";
    }
  } catch (error) {
    console.log(error);
  }
}

const firm = () => {
  (function () {
    // Comenzamos una funcion auto-ejecutable

    $clearBtn = document.getElementById("clearBtn");
    $canvas = document.querySelector("#firmaPreOperativo");

    // Obtenenemos un intervalo regular(Tiempo) en la pamtalla
    window.requestAnimFrame = (function (callback) {
      return (
        window.requestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        window.oRequestAnimationFrame ||
        window.msRequestAnimaitonFrame ||
        function (callback) {
          window.setTimeout(callback, 1000 / 60);
          // Retrasa la ejecucion de la funcion para mejorar la experiencia
        }
      );
    })();

    // Traemos el canvas mediante el id del elemento html

    var ctx = $canvas.getContext("2d");

    const canvasEmpty = () => {};

    $("#controlEnviar").mouseover(function () {
      var cnv = document.getElementById("firmaPreOperativo");
      if (isCanvasEmpty(cnv))
        swal({
          icon: "warning",
          title: "ADVERTENCIA",
          text: "Recuerde Firma del INVIMA",
        });
    });
    function isCanvasEmpty(cnv) {
      const blank = document.createElement("canvas");

      blank.width = cnv.width;
      blank.height = cnv.height;

      return cnv.toDataURL() === blank.toDataURL();
    }

    // Mandamos llamar a los Elemetos interactivos de la Interfaz HTML

    var submitBtn = document.getElementById("draw-submitBtn");
    $clearBtn.addEventListener(
      "click",
      function (e) {
        // Definimos que pasa cuando el boton draw-clearBtn es pulsado
        clearCanvas();
      },
      false
    );
    // Definimos que pasa cuando el boton draw-submitBtn es pulsado

    // Activamos MouseEvent para nuestra pagina
    var drawing = false;
    var mousePos = { x: 0, y: 0 };
    var lastPos = mousePos;
    $canvas.addEventListener(
      "mousedown",
      function (e) {
        /*
              Mas alla de solo llamar a una funcion, usamos function (e){...}
              para mas versatilidad cuando ocurre un evento
            */

        console.log(e);
        drawing = true;
        lastPos = getMousePos($canvas, e);
      },
      false
    );
    $canvas.addEventListener(
      "mouseup",
      function (e) {
        drawing = false;
      },
      false
    );
    $canvas.addEventListener(
      "mousemove",
      function (e) {
        mousePos = getMousePos($canvas, e);
      },
      false
    );

    // Activamos touchEvent para nuestra pagina
    $canvas.addEventListener(
      "touchstart",
      function (e) {
        mousePos = getTouchPos($canvas, e);
        console.log(mousePos);
        e.preventDefault(); // Prevent scrolling when touching the $canvas
        var touch = e.touches[0];
        var mouseEvent = new MouseEvent("mousedown", {
          clientX: touch.clientX,
          clientY: touch.clientY,
        });
        $canvas.dispatchEvent(mouseEvent);
      },
      false
    );
    $canvas.addEventListener(
      "touchend",
      function (e) {
        e.preventDefault(); // Prevent scrolling when touching the $canvas
        var mouseEvent = new MouseEvent("mouseup", {});
        $canvas.dispatchEvent(mouseEvent);
      },
      false
    );
    $canvas.addEventListener(
      "touchleave",
      function (e) {
        // Realiza el mismo proceso que touchend en caso de que el dedo se deslice fuera del $canvas
        e.preventDefault(); // Prevent scrolling when touching the $canvas
        var mouseEvent = new MouseEvent("mouseup", {});
        $canvas.dispatchEvent(mouseEvent);
      },
      false
    );
    $canvas.addEventListener(
      "touchmove",
      function (e) {
        e.preventDefault(); // Prevent scrolling when touching the $canvas
        var touch = e.touches[0];
        var mouseEvent = new MouseEvent("mousemove", {
          clientX: touch.clientX,
          clientY: touch.clientY,
        });
        $canvas.dispatchEvent(mouseEvent);
      },
      false
    );

    // Get the position of the mouse relative to the $canvas
    function getMousePos(canvasDom, mouseEvent) {
      var rect = canvasDom.getBoundingClientRect();
      /*
              Devuelve el tamaño de un elemento y su posición relativa respecto
              a la ventana de visualización (viewport).
            */
      return {
        x: mouseEvent.clientX - rect.left,
        y: mouseEvent.clientY - rect.top,
      };
    }

    // Get the position of a touch relative to the canvas
    function getTouchPos(canvasDom, touchEvent) {
      var rect = canvasDom.getBoundingClientRect();
      console.log(touchEvent);
      /*
              Devuelve el tamaño de un elemento y su posición relativa respecto
              a la ventana de visualización (viewport).
            */
      return {
        x: touchEvent.touches[0].clientX - rect.left, // Popiedad de todo evento Touch
        y: touchEvent.touches[0].clientY - rect.top,
      };
    }

    // Draw to the canvas
    function renderCanvas() {
      if (drawing) {
        ctx.beginPath();
        ctx.moveTo(lastPos.x, lastPos.y);
        ctx.lineTo(mousePos.x, mousePos.y);

        ctx.lineWidth = 2;
        ctx.stroke();
        ctx.closePath();
        lastPos = mousePos;
      }
    }

    function clearCanvas() {
      $canvas.width = $canvas.width;
    }

    // Allow for animation
    (function drawLoop() {
      requestAnimFrame(drawLoop);
      renderCanvas();
    })();
  })();
  /* const $btnSend = document.querySelector('#prueba');
    $btnSend.onclick = async (e) => {
        
        const data = $canvas.toDataURL("image/png");
        const fd = new FormData();
        fd.append("imagen", data); // Se llama "imagen", en PHP lo recuperamos con $_POST["imagen"]
        const respuestaHttp = await fetch("../controller/REGISTROS.php", {
            method: "POST",
            
           
        });
        const nombreImagenSubida = await respuestaHttp.json();
        console.log("La imagen ha sido enviada y tiene el nombre de: " + nombreImagenSubida);
    } */
  document.getElementById("frmio").addEventListener(
    "submit",
    function (e) {
      var image = $canvas.toDataURL(); // data:image/png....
      document.getElementById("base64").value = image;
    },
    false
  );
};
/* firm() */

/* document.getElementById('clicks').addEventListener('click', function (evt) {
    var target = evt.target;
    if (target.id === 'aPlataformaPoes') {
        $clearBtn = document.getElementById("draw-clearBtn");
        $canvas = document.querySelector("#firmaEscaldadoPoes");
        firm();
    } else if (target.id === 'aEvisceracionPoes') {
        $clearBtn = document.getElementById("draw-clearBtn-Evisc");
        $canvas = document.querySelector("#firmaEviscPoes");
        firm();
    } else if (target.id === 'aViscerasPoes') {
        $clearBtn = document.getElementById("draw-clearBtn-Visc");
        $canvas = document.querySelector("#firmaViscerasPoes");
        firm();
    } else if (target.id === 'aEnfriamientoPoes') {
        $clearBtn = document.getElementById("draw-clearBtn-Enfri");
        $canvas = document.querySelector("#firmaEnfriamientoPoes");
        firm();
    } else if (target.id === 'aDespresePoes') {
        $clearBtn = document.getElementById("draw-clearBtn-Desp");
        $canvas = document.querySelector("#firmaDespresePoes");
        firm();
    } else if (target.id === 'aFileteoPoes') {
        $clearBtn = document.getElementById("draw-clearBtn-File");
        $canvas = document.querySelector("#firmaFileteoPoes");
        firm();
    } else if (target.id === 'aProcesoPoes') {
        $clearBtn = document.getElementById("draw-clearBtn-Proces");
        $canvas = document.querySelector("#firmaProcesoPoes");
        firm();
    } else if (target.id === 'aSalmueraPoes') {
        $clearBtn = document.getElementById("draw-clearBtn-Salmu");
        $canvas = document.querySelector("#firmaSalmueraPoes");
        firm();
    } else if (target.id === 'aAlimentacionPoes') {
        $clearBtn = document.getElementById("draw-clearBtn-Alim");
        $canvas = document.querySelector("#firmaAlimentacionPoes");
        firm();
    } else if (target.id === 'aCanastillaPoes') {
        $clearBtn = document.getElementById("draw-clearBtn-Canast");
        $canvas = document.querySelector("#firmaCanastillaPoes");
        firm();
    } else {
        $clearBtn = document.getElementById("draw-clearBtn-Lavan");
        $canvas = document.querySelector("#firmaLavanderiaPoes");
        firm();
    }
}, false); */

const firmBPM = () => {
  (function () {
    // Comenzamos una funcion auto-ejecutable

    $clearBtnBPM = document.getElementById("clearBtnBPM");
    $canvas = document.querySelector("#firmaBPM");

    // Obtenenemos un intervalo regular(Tiempo) en la pamtalla
    window.requestAnimFrame = (function (callback) {
      return (
        window.requestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        window.oRequestAnimationFrame ||
        window.msRequestAnimaitonFrame ||
        function (callback) {
          window.setTimeout(callback, 1000 / 60);
          // Retrasa la ejecucion de la funcion para mejorar la experiencia
        }
      );
    })();

    // Traemos el canvas mediante el id del elemento html

    var ctx = $canvas.getContext("2d");

    const canvasEmpty = () => {};

    $("#controlEnviar").mouseover(function () {
      var cnv = document.getElementById("firmaBPM");
      if (isCanvasEmpty(cnv))
        swal({
          icon: "warning",
          title: "ADVERTENCIA",
          text: "Recuerde Firma del INVIMA",
        });
    });
    function isCanvasEmpty(cnv) {
      const blank = document.createElement("canvas");

      blank.width = cnv.width;
      blank.height = cnv.height;

      return cnv.toDataURL() === blank.toDataURL();
    }

    // Mandamos llamar a los Elemetos interactivos de la Interfaz HTML

    var submitBtn = document.getElementById("draw-submitBtn");
    $clearBtnBPM.addEventListener(
      "click",
      function (e) {
        // Definimos que pasa cuando el boton draw-clearBtn es pulsado
        clearCanvas();
      },
      false
    );
    // Definimos que pasa cuando el boton draw-submitBtn es pulsado

    // Activamos MouseEvent para nuestra pagina
    var drawing = false;
    var mousePos = { x: 0, y: 0 };
    var lastPos = mousePos;
    $canvas.addEventListener(
      "mousedown",
      function (e) {
        /*
              Mas alla de solo llamar a una funcion, usamos function (e){...}
              para mas versatilidad cuando ocurre un evento
            */

        console.log(e);
        drawing = true;
        lastPos = getMousePos($canvas, e);
      },
      false
    );
    $canvas.addEventListener(
      "mouseup",
      function (e) {
        drawing = false;
      },
      false
    );
    $canvas.addEventListener(
      "mousemove",
      function (e) {
        mousePos = getMousePos($canvas, e);
      },
      false
    );

    // Activamos touchEvent para nuestra pagina
    $canvas.addEventListener(
      "touchstart",
      function (e) {
        mousePos = getTouchPos($canvas, e);
        console.log(mousePos);
        e.preventDefault(); // Prevent scrolling when touching the $canvas
        var touch = e.touches[0];
        var mouseEvent = new MouseEvent("mousedown", {
          clientX: touch.clientX,
          clientY: touch.clientY,
        });
        $canvas.dispatchEvent(mouseEvent);
      },
      false
    );
    $canvas.addEventListener(
      "touchend",
      function (e) {
        e.preventDefault(); // Prevent scrolling when touching the $canvas
        var mouseEvent = new MouseEvent("mouseup", {});
        $canvas.dispatchEvent(mouseEvent);
      },
      false
    );
    $canvas.addEventListener(
      "touchleave",
      function (e) {
        // Realiza el mismo proceso que touchend en caso de que el dedo se deslice fuera del $canvas
        e.preventDefault(); // Prevent scrolling when touching the $canvas
        var mouseEvent = new MouseEvent("mouseup", {});
        $canvas.dispatchEvent(mouseEvent);
      },
      false
    );
    $canvas.addEventListener(
      "touchmove",
      function (e) {
        e.preventDefault(); // Prevent scrolling when touching the $canvas
        var touch = e.touches[0];
        var mouseEvent = new MouseEvent("mousemove", {
          clientX: touch.clientX,
          clientY: touch.clientY,
        });
        $canvas.dispatchEvent(mouseEvent);
      },
      false
    );

    // Get the position of the mouse relative to the $canvas
    function getMousePos(canvasDom, mouseEvent) {
      var rect = canvasDom.getBoundingClientRect();
      /*
              Devuelve el tamaño de un elemento y su posición relativa respecto
              a la ventana de visualización (viewport).
            */
      return {
        x: mouseEvent.clientX - rect.left,
        y: mouseEvent.clientY - rect.top,
      };
    }

    // Get the position of a touch relative to the canvas
    function getTouchPos(canvasDom, touchEvent) {
      var rect = canvasDom.getBoundingClientRect();
      console.log(touchEvent);
      /*
              Devuelve el tamaño de un elemento y su posición relativa respecto
              a la ventana de visualización (viewport).
            */
      return {
        x: touchEvent.touches[0].clientX - rect.left, // Popiedad de todo evento Touch
        y: touchEvent.touches[0].clientY - rect.top,
      };
    }

    // Draw to the canvas
    function renderCanvas() {
      if (drawing) {
        ctx.beginPath();
        ctx.moveTo(lastPos.x, lastPos.y);
        ctx.lineTo(mousePos.x, mousePos.y);

        ctx.lineWidth = 2;
        ctx.stroke();
        ctx.closePath();
        lastPos = mousePos;
      }
    }

    function clearCanvas() {
      $canvas.width = $canvas.width;
    }

    // Allow for animation
    (function drawLoop() {
      requestAnimFrame(drawLoop);
      renderCanvas();
    })();
  })();
  /* const $btnSend = document.querySelector('#prueba');
    $btnSend.onclick = async (e) => {
        
        const data = $canvas.toDataURL("image/png");
        const fd = new FormData();
        fd.append("imagen", data); // Se llama "imagen", en PHP lo recuperamos con $_POST["imagen"]
        const respuestaHttp = await fetch("../controller/REGISTROS.php", {
            method: "POST",
            
           
        });
        const nombreImagenSubida = await respuestaHttp.json();
        console.log("La imagen ha sido enviada y tiene el nombre de: " + nombreImagenSubida);
    } */
  document.getElementById("frmio").addEventListener(
    "submit",
    function (e) {
      var image = $canvas.toDataURL(); // data:image/png....
      document.getElementById("base64BPM").value = image;
    },
    false
  );
};